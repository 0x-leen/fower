---
id: use-with-react
title: 在 React 中使用
---

Styli 非常适合在 React 中使用，接下来我们看看如何在 React 中优雅的使用 Styli。

## 安装

```bash
npm i @styli/core @styli/react @styli/preset-default
```

注意，除了需要 `@styli/core`，你还需安装和 React 对应的组件包 `@styli/react`。

## 初始化 Preset

在使用 Styli 编写样式之前，你需要通过 `styli.configure(preset)` 初始化插件。

```js title="src/index.ts"
import { styli } from '@styli/core'
import preset from '@styli/preset-default'

styli.configure(preset)
```

Styli 是插件化的，`@styli/core` 未内置任何插件，`@styli/preset-default` 预置了一些官方插件，你也可以新建自己的 Preset 来配置插件。

## 在组件中使用

下面我们使用 `View`、`Image`、`Text` 三个组件，实现一个用户信息卡片界面。

```jsx title="src/components/ProfileCard.ts"
import React from 'react'
import { View, Text, Image } from '@styli/react'

export default () => {
  return (
    <View centerY p-10 w-260 bgWhite rounded-10 shadowMD>
      <Imagecircle-48 src="/img/jobs.jpg" />
      <View ml-10>
        <View f-20 fontBold>
          Steve Jobs
        </View>
        <Text gray80>Co-founder of Apple Inc.</Text>
      </View>
    </View>
  )
}
```

上面的代码将实现下面的 UI 效果：

```jsx live
<View bgGray10 p6>
  <View centerY p-10 w-260 bgWhite rounded-10 shadowMD>
    <Imagecircle-48 src="/img/jobs.jpg" />
    <View ml-10>
      <View f-20 fontBold>
        Steve Jobs
      </View>
      <Text gray80>Co-founder of Apple Inc.</Text>
    </View>
  </View>
</View>
```

可以看到，我们用非常简洁的代码，实现了一个比较复杂的界面。咋一看，你可能会说："这不是变相的内联样式吗？"，这确实和内联样式相似，把样式写在 JSX 上，但这也许这是他们唯一的相似点。Styli 编写样式的方式，我们况且称之为 "Atomic props" 吧。

相比内联样式，"Atomic props"有很多优点：

- **代码更简洁**，使用内联样式代码量更大，很容易让 JSX 变得乱糟糟，但使用 "Atomic props" 保留了 JSX 的简洁性，可读性更好。

- **样式复用**，使用内联样式，很容易让代码快速膨胀，使用 "Atomic props"，代码大小并不会随着项目的大小膨胀太多。

## @styli/react

`@styli/react` 的代码非常简单，里面没有任何黑魔法，只是用 `styled` 对 html 元素进行简单包裹。

```jsx title="@styli/react 源码"
import { styled } from '@styli/styled'

export const View = styled('div')
export const Text = styled('span')
export const Image = styled('img')
export const Anchor = styled('a')
export const Heading = styled('h2')
```

> 注意，自定义 Styli 组件时，你需要使用 `@styli/styled` 里的 `styled` Api。

你也可以直接在 Github 中查看`@styli/react`的源码：[Souce code](https://github.com/forsigner/styli/blob/master/packages/react/src/index.tsx)。

我们可以看到，`@styli/react` 只提供了 `View`、`Text`、`Image`、`Anchor`、`Heading` 几个组件。在开发的过程中，我们建议根据自己的需要封装属于自己的组件。

例如，你可以喜欢 html 元素的风格，那可以封装一套这样的组件：

```jsx title="@styli/react 源码"
import { styled } from '@styli/styled'

export const Div = styled('div')
export const Span = styled('span')
export const Img = styled('img')
export const Button = styled('button')
export const Input = styled('input')
export const P = styled('p')
export const H1 = styled('h1')
export const H2 = styled('h2')

// more....
```

## 直接 HTML 元素中使用

Styli 的原子属性(Atomic Props)也可以直接在 JSX html tag 中使用。也就是到说，你直接可以在 html 标签中添加原子属性，代码类似下面：

```jsx
<div p6 f5 bgRed20>
  Use styli in HTML tag
</div>
```

要在 html 标签中使用原子属性，可以有两种使用方式：

- Babel Preset
- JSX Pragma

### Babel Preset

第一种方式是通过配置 babel，为项目添加 babel preset: `@styli/babel-preset-styli`。

```json title=".babelrc"
{
  "presets": ["@styli/babel-preset-styli"]
}
```

然后，你就可以在 HTML 元素中使用原子属性了：

```jsx
import React from 'react'

export default () => {
  return (
    <div p6 f5 bgRed20>
      Use styli with Babel Preset
    </div>
  )
}
```

注意，如果你想获得 TypeScript 类型提示，你需要扩展 HTML 的属性类型，方法是在项目根目录新建一个 `d.ts` 类型文件，名字可以为 `index.d.ts`，内容如下：

```jsx title="index.d.ts"
import { AtomicProps } from '@styli/types';

declare module 'react' {
  interface HTMLAttributes<T> extends AtomicProps {}
}

```

### JSX Pragma

如果你无法控制项目的 babel 配置，你可以通过 `JSX Pragma` 的方式：

```jsx
/** @jsx jsx */
import { jsx } from '@styli/react'

export default () => {
  return (
    <div p6 f5 bgOrange20>
      Use styli with JSX Pragma
    </div>
  )
}
```

为什么上面的组件可以在 HTML 中直接使用原子属性呢？是因为组件的开头增加下面 `JSX Pragma` 的声明。

```jsx
/** @jsx jsx */
import { jsx } from '@styli/react'
```

## 例子源码

你可以查看 React 中使用的源码：[examples/use-with-react](https://github.com/forsigner/styli/tree/master/examples/use-with-react)
